



#  """
# LLM prompts for lead analysis.
# """

BATCH_PROMPT = """Проанализируй сообщения из Telegram чатов.
Определи, выражает ли автор каждого сообщения интерес к:
1. АРЕНДЕ или ПОКУПКЕ НЕДВИЖИМОСТИ (type: "property")
2. АРЕНДЕ ТРАНСПОРТА (type: "vehicle")

=== НЕДВИЖИМОСТЬ (property) ===
Признаки лида:
- Ищет квартиру/дом/комнату/кондо в аренду или на покупку
- Спрашивает о ценах на недвижимость
- Ищет риелтора или агентство

НЕ лид (Лендлорды/Предложения):
- "Сдаю", "Сдается", "Available", "For rent", "My condo"
- "Свободные даты", "Free dates"
- Предлагает свою недвижимость
- Ищет ОТЕЛЬ, гостиницу, хостел или посуточную аренду (только долгосрок!)

=== ТРАНСПОРТ (vehicle) ===
Признаки лида:
- Ищет машину/автомобиль в аренду
- Ищет мотоцикл/байк в аренду
- Ищет скутер/мопед в аренду
- Хочет КУПИТЬ транспорт 

НЕ лид (Арендодатели/Предложения):
- "Сдаю байк", "В наличии", "Available for rent", "I have bike"
- Предлагает транспорт в аренду
- Ищет ВОДНЫЙ транспорт: лодки, катера, яхты, гидроциклы, jet ski

=== ОБЩИЕ ИСКЛЮЧЕНИЯ ===
- Обсуждает без намерения арендовать/купить
- Просто комментирует чужое предложение без собственного запроса (кроме вопросов цены/деталей покупки)
- Реклама/спам

ФОРМАТ ОТВЕТОВ: 
- Сообщения с "(↩ ...)" — ответы на другие сообщения.
- Сообщения с одинаковым (user:ID) — от одного человека. Анализируй их ВМЕСТЕ как один потенциальный лид.

ВАЖНО: Верни ТОЛЬКО лиды. Если лидов нет — верни пустой массив [].
Если несколько сообщений от одного user_id — верни ОДИН лид с любым id из его сообщений.

Формат ответа (ТОЛЬКО JSON без markdown):
[{{"id": номер, "type": "property"|"vehicle", "confidence": 0.0-1.0, "reason": "Локация: ..., Бюджет: ..., Срок: ..."}}]
(В поле reason обязательно укажи Локацию, Бюджет и Срок, если они есть в тексте. Если нет — краткую суть запроса).

Сообщения:
{messages}
"""


